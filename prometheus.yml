# =====================================================================
# Prometheus Scrape Configuration
# =====================================================================
# Prometheus, with this config, periodically pulls Micrometer metrics
# from Flight Aggregator and provider services.
#
# Spring Boot Actuator exposes the /actuator/prometheus endpoint.
# =====================================================================

global:
  # Default scrape interval for each service
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  # ----- Flight Aggregator (Ana uygulama) -----
  - job_name: "flight-aggregator"
    metrics_path: "/actuator/prometheus"
    static_configs:
      - targets: ["flight-aggregator:8080"]
    # Micrometer additional labels
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: "flight-aggregator"

  # ----- Flight Provider A (SOAP service) -----
  - job_name: "flight-provider-a"
    metrics_path: "/actuator/prometheus"
    static_configs:
      - targets: ["flight-provider-a:8081"]
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: "flight-provider-a"

  # ----- Flight Provider B (SOAP service) -----
  - job_name: "flight-provider-b"
    metrics_path: "/actuator/prometheus"
    static_configs:
      - targets: ["flight-provider-b:8082"]
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: "flight-provider-b"

  # ----- Prometheus itself -----
  - job_name: "prometheus"
    static_configs:
      - targets: ["localhost:9090"]
